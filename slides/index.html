<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <!-- <link rel="stylesheet" href="dist/reset.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/reset.min.css" integrity="sha512-Mjxkx+r7O/OLQeKeIBCQ2yspG1P5muhAtv/J+p2/aPnSenciZWm5Wlnt+NOUNA4SHbnBIE/R2ic0ZBiCXdQNUg==" crossorigin="anonymous" />
    <!-- <link rel="stylesheet" href="dist/reveal.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/reveal.min.css" integrity="sha512-zu0eodDPCBAZf1vnIgwZ6qchMBt1xqgGkS9vBjVmunoH8pU7cc9OQKBiSQCclpvqySupy9Y1pLZc87VB40G4Sw==" crossorigin="anonymous" />
    <!-- <link rel="stylesheet" href="dist/theme/black.css" id="theme"> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/theme/white.min.css" integrity="sha512-4D8b66djW61D6twJNMNqyRrS8wCmCDyVQaME8E5CyGj2wRGsQUz6Y7qa2W0rEvYaaju9OHGxVPd173eBAaMAOQ==" crossorigin="anonymous" /> -->
    <link rel="stylesheet" href="assets/nord.css">
    <link rel="stylesheet" href="assets/custom.css">

    <!-- Theme used for syntax highlighted code -->
    <!-- <link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/highlight/monokai.min.css" integrity="sha512-z8wQkuDRFwCBfoj7KOiu1MECaRVoXx6rZQWL21x0BsVVH7JkqCp1Otf39qve6CrCycOOL5o9vgfII5Smds23rg==" crossorigin="anonymous" />
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <section id="title-slide">
                <h2>Magical NumPy with JAX</h2>
                <p>Eric J. Ma</p>
                <p>PyCon 2021</p>
            </section>
            <section id="about-me">
                <h2>About Me</h2>
                <br>
                <div class="container">
                    <div class="col grow">
                        2017-Present: Novartis Institutes for BioMedical Research
                    </div>
                    <div class="col grow">
                        2011-2017: MIT Biological Engineering
                    </div>
                </div>
            </section>
            <section id="preamble">
                <section id="jax-logo">
                    <h2>What is JAX?</h2>
                    <img class="plain grow" src="https://raw.githubusercontent.com/google/jax/master/images/jax_logo_250px.png">
                </section>
                <section id="repository">
                    <a href="https://github.com/google/jax">google/jax</a>
                </section>
                <section id="composable-transforms">
                    <p>A system for composable transforms on NumPy programs.</p>
                    <br>
                    <small class="fragment"><em>We will explain that in a moment!</em></small>
                </section>
                <section id="prerequisites">
                    <h2>Prerequisites</h2>
                </section>
                <section id="familiarity">
                    <p>Familiar with the NumPy API</p>
                    <img class="plain grow embiggen" src="https://numpy.org/images/logos/numpy.svg">
                </section>
                <section>
                    <p>Understand what a dot product is</p>
                </section>
                <section>
                    <p>Familiarity with the Jupyter user interface</p>
                    <img class="plain grow embiggen" src="https://jupyter.org/assets/main-logo.svg">
                </section>
                <section>
                    <p>Ready to be challenged by array computing puzzles</p>
                </section>
                <section id="important-links">
                    <h2>Important Links</h2>
                </section>
                <section id="url-to-repo">
                    <a href="https://ericmjl.github.io/dl-workshop">ericmjl.github.io/dl-workshop</a>
                </section>
                <section id="tutorial-format">
                    <h2>Tutorial format</h2>
                </section>
                <section id="pre-recorded-lectures">
                    <p>Pre-recorded lecture component:</p>
                    <ul>
                        <li>saves my throat</li>
                        <li>keeps my energy levels high for live Q&A</li>
                    </ul>
                </section>
                <section id="live-qa">
                    <p>Live Q&A in between videos</p>
                </section>
                <section id="exercises">
                    <p>Exercises in Jupyter notebooks</p>
                    <p>
                        <a href="https://mybinder.org/v2/gh/ericmjl/dl-workshop/master">
                            <img class="plain blowup" src="https://mybinder.org/badge_logo.svg">
                        </a>
                    </p>
                </section>
                <section>Let's get started!</section>
            </section>
            <section id="loopless-loops">
                <section>
                    <h2>Loopless Loops</h2>
                </section>
                <section>
                    <p>Vectorized mapping a.k.a. <code>vmap</code></p>
                </section>
                <section>
                    <p>The semantics of <code>vmap</code> look roughly like this:</p>
                    <pre><code data-trim class="python grow">
def func(x):
    ...
    return result


def vmapped_func(array):
    result = []
    for element in array:
        result.append(func(x))
    result = np.stack(result)
    return result
                    </code></pre>
                </section>

                <section id="example-vmap-square">
                    <p>Example</p>
                    <pre><code data-trim class="python grow">
import jax.numpy as np
a = np.arange(20)   # (20,)

def square(x: int) -> int:
    return x ** 2

from jax import vmap
mapped_sq = vmap(square)  # this is a function!
mapped_sq(a)
# vmap(square)(a) works too!
                    </code></pre>
                    <p>Vectorized maps apply a single function along the <em>leading axis</em> (axis 0) of an array.</p>
                </section>
                <section>
                    <p><code>vmap</code> takes in a function and returns another function.</p>
                    <p class="fragment">The new function automatically applies the original function along the leading axis.</p>
                </section>
                <section id="example-vmap-row-summation">
                    <p>Example</p>
                    <pre><code data-trim class="python grow">
def sum_vector(x: np.ndarray) -> np.ndarray:
    """Assumes `x` is a vector"""
    return np.sum(x)

a = np.arange(20).reshape((4, 5))
vmap(sum_vector)(a)          # shape: (4,)
vmap(sum_vector, in_axes=1)(a)  # shape: (5,)
                    </code></pre>
                    <p><code>in_axes</code> specifies along which axis the function ought to be applied.</p>
                </section>
                <section id="example-vmap-softmax">
                    <p>Example</p>
                    <pre><code data-trim class="python grow">
def softmax(x: np.ndarray) -> np.ndarray:
    """Vector-wise softmax transform."""
    return np.exp(x) / np.sum(np.exp(x))

a = np.arange(16).reshape((4, 4))
vmap(softmax)(a)             # row-wise normalization of a
vmap(softmax, in_axes=1)(a)  # column-wise normalization of a
                    </code></pre>
                    <p><code>in_axes</code> specifies along which axis the function ought to be applied.</p>
                    <small>The softmax operation is used widely in the deep learning world.</small>
                </section>
                <section id="example-4">
                    <p>Example: Functions with two arguments</p>
                    <pre><code data-trim class="python grow">
def angle(opp: float, adj: float):
    return np.arctan(opp / adj)

opps = np.arange(20)
adjs = np.linspace(3, 30, 20)

vmap(angle)(opps, adjs)
                    </code></pre>
                    <p>The function is now vmapped across the leading axis of <em>both</em> arguments.</p>
                </section>
                <section>
                    <h2>Exercises!</h2>
                    <p>We have gone through the content of the first notebook called "loopless loops". It's time now to attempt the exercises in there!</p>
                    <small>Time budget: 20 minutes.</small>
                    <br>
                    <small>Ask questions in the chat, and I will respond there.</small>
                    <br>
                    <small>Up-vote questions you'd like to hear answered live.</small>
                </section>
            </section>
            <section id="loopy-carry">
            </section>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/reveal.min.js" integrity="sha512-Xu/cezKABTI81MGnaBm64vdiS7XkttHeYGOgr2Mdga0bTplSBGongLq2lhK2HwL79wefKM0u4uTCLD0ha1sRzQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/notes/notes.min.js" integrity="sha512-FYeeQscKqibmYKr0+nE2+fN5prBsFwgjsBVwkrA88O6mN2+ai6EvRkSi6txuhXlWsyK1MUfoV+94+q6HLouJSQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/markdown/markdown.min.js" integrity="sha512-eZZqO4ECmVvGhCt+6VZ7ian2bCu4S6yrjSFH9fXLY1zTokpAWsxAxQwM4x6+7G+G4ha5tFIe0jY0XjpBUqS49Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/highlight/highlight.min.js" integrity="sha512-NA5UCab7xDKQPXGsmIp8iEuId5BAKGPiqHZsZQcBuySfp1n3dZrwBDKpPNL23Db5upay1nULxU14JV1ggFOD2A==" crossorigin="anonymous"></script>
    <script>
        // More info about initialization & config:
        // - https://revealjs.com/initialization/
        // - https://revealjs.com/config/
        Reveal.initialize({
            hash: true,

            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
        });
    </script>
</body>
</html>
